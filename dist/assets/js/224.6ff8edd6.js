"use strict";(self["webpackChunkneat"]=self["webpackChunkneat"]||[]).push([[224],{7224:function(e,a,o){o.r(a),o.d(a,{default:function(){return X}});var s=o(6630),l=(o(924),o(9843)),t=(o(2181),o(7051)),n=o(2316),r=(o(5799),o(3396));const i=e=>((0,r.dD)("data-v-7e2dba3e"),e=e(),(0,r.Cn)(),e),d={key:0,class:"login container shadow"},m=i((()=>(0,r._)("i",{class:"bi bi-box-arrow-right"},null,-1))),g=(0,r.Uk)("返回首页"),u=[m,g],c=i((()=>(0,r._)("h4",{class:"title"},"登录",-1))),p=i((()=>(0,r._)("p",{class:"text m2-5"},"请输入账号密码进行登录",-1))),f={class:"tips"},w=(0,r.Uk)("记住密码 "),I=(0,r.Uk)("点击登录"),k={class:"text mt-4"},h=(0,r.Uk)("还没有账号?"),b={key:1,class:"register container shadow"},y=i((()=>(0,r._)("i",{class:"bi bi-box-arrow-right"},null,-1))),v=(0,r.Uk)("返回首页"),V=[y,v],C=i((()=>(0,r._)("h4",{class:"title"},"注册",-1))),_=i((()=>(0,r._)("p",{class:"text m2-5"},"请填写正确的信息，方便找回密码！",-1))),W=(0,r.Uk)("获取验证码"),U={class:"tips mt-3"},L=(0,r.Uk)("我同意用户协议 "),S=(0,r.Uk)("点击注册"),R={class:"text mt-4"},x=(0,r.Uk)("已有账号?");function Z(e,a,o,i,m,g){const y=n.EZ,v=l.nH,Z=t.OX,z=l.ly,B=s.mi;return(0,r.wg)(),(0,r.iD)("div",null,[i.LoginIsRegister?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("span",{class:"back mb-5",onClick:a[0]||(a[0]=(...e)=>i.goBack&&i.goBack(...e))},u),c,p,(0,r.Wm)(z,{"label-position":"top","label-width":"100px",model:i.loginInfo,size:"large"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,{modelValue:i.loginInfo.username,"onUpdate:modelValue":a[1]||(a[1]=e=>i.loginInfo.username=e),placeholder:"用户名"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,{modelValue:i.loginInfo.password,"onUpdate:modelValue":a[2]||(a[2]=e=>i.loginInfo.password=e),type:"password",placeholder:"密码","show-password":""},null,8,["modelValue"])])),_:1}),(0,r._)("p",f,[(0,r.Wm)(Z,{modelValue:i.loginInfo.saveLoginInfo,"onUpdate:modelValue":a[3]||(a[3]=e=>i.loginInfo.saveLoginInfo=e),size:"small",class:"pe-2"},null,8,["modelValue"]),w])])),_:1},8,["model"]),(0,r.Wm)(B,{type:"primary",class:"d-block",onClick:i.login,loading:i.loginOrRegisterButtonStatus},{default:(0,r.w5)((()=>[I])),_:1},8,["onClick","loading"]),(0,r._)("p",k,[h,(0,r._)("span",{class:"ps-2",onClick:a[4]||(a[4]=(...e)=>i.LoginIsRegisterChange&&i.LoginIsRegisterChange(...e))},"注册")])])),i.LoginIsRegister?((0,r.wg)(),(0,r.iD)("div",b,[(0,r._)("span",{class:"back mb-5",onClick:a[5]||(a[5]=(...e)=>i.goBack&&i.goBack(...e))},V),C,_,(0,r.Wm)(z,{"label-position":"top","label-width":"100px",model:i.registerInfo,size:"large"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,{modelValue:i.registerInfo.nickname,"onUpdate:modelValue":a[6]||(a[6]=e=>i.registerInfo.nickname=e),placeholder:"用户名"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,{modelValue:i.registerInfo.password,"onUpdate:modelValue":a[7]||(a[7]=e=>i.registerInfo.password=e),placeholder:"密码","show-password":""},null,8,["modelValue"])])),_:1}),(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,{modelValue:i.registerInfo.email,"onUpdate:modelValue":a[8]||(a[8]=e=>i.registerInfo.email=e),placeholder:"电子邮箱"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(v,{class:"mt-4"},{default:(0,r.w5)((()=>[(0,r.Wm)(y,{modelValue:i.registerInfo.code,"onUpdate:modelValue":a[9]||(a[9]=e=>i.registerInfo.code=e),placeholder:"验证码"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(B,{onClick:i.GetVerifyCode,loading:i.verifyCodeButtonStatus},{default:(0,r.w5)((()=>[W])),_:1},8,["onClick","loading"]),(0,r._)("p",U,[(0,r.Wm)(Z,{modelValue:i.registerInfo.agreement,"onUpdate:modelValue":a[10]||(a[10]=e=>i.registerInfo.agreement=e),size:"small",class:"pe-2"},null,8,["modelValue"]),L])])),_:1},8,["model"]),(0,r.Wm)(B,{type:"primary",class:"d-block",onClick:i.register,loading:i.loginOrRegisterButtonStatus},{default:(0,r.w5)((()=>[S])),_:1},8,["onClick","loading"]),(0,r._)("p",R,[x,(0,r._)("span",{class:"ps-2",onClick:a[11]||(a[11]=(...e)=>i.LoginIsRegisterChange&&i.LoginIsRegisterChange(...e))},"登录")])])):(0,r.kq)("",!0)])}var z=o(4870),B=o(7139),M=o(678),A=o(327),O=o(6038);const T=({username:e,password:a})=>O.Z.post("api/users",{},{headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{mode:"login",account:e,password:a}}),q=({nickname:e,email:a,password:o,code:s})=>O.Z.post("api/users",{},{headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{mode:"register",nickname:e,email:a,password:o,code:s}}),D=e=>O.Z.post("api/verify-code",{},{headers:{"Content-Type":"application/x-www-form-urlencoded"},params:{mode:"create",email:e}}),G=(e,a)=>{const o=(0,B.oR)(),s=(0,z.qj)({username:localStorage.getItem("username")?localStorage.getItem("username"):"",password:localStorage.getItem("password")?localStorage.getItem("password"):"",saveLoginInfo:!!localStorage.getItem("password")}),l=async()=>{if(a.value=!0,""===s.username||""===s.password)return(0,A.bM)({title:"错误",message:"请填写用户名或密码",type:"error",duration:3500}),a.value=!1,!1;const{data:l}=await T(s);if(200!==l.code)return(0,A.bM)({title:"错误",message:l.msg,type:"error",duration:3500}),a.value=!1,!1;o.dispatch("LoginInfo",l.data),o.dispatch("LoginInfoToken",Object.values(l.data)[0]),!0===s.saveLoginInfo?(localStorage.setItem("username",s.username),localStorage.setItem("password",s.password)):(localStorage.removeItem("username"),localStorage.removeItem("password")),(0,A.bM)({title:"成功",message:l.msg,type:"success",duration:3500}),a.value=!1,e.go(-1)};return{login:l,loginInfo:s}},H=(e,a,o)=>{const s=(0,z.qj)({nickname:"",password:"",email:"",code:"",agreement:!1}),l=async()=>{if(""===s.email)return(0,A.bM)({title:"警告",message:"邮箱不能为空",type:"error",duration:3500}),!1;if(-1===s.email.search(/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/))return(0,A.bM)({title:"警告",message:"请确认邮箱格式是否正确",type:"error",duration:3500}),!1;o.value=!0;const{data:e}=await D(s.email);"验证码已发送至邮箱，5分钟内有效！"===e.msg||"验证码已发送至邮箱5分钟内有效！"===e.msg?((0,A.bM)({title:"成功",message:e.msg,type:"success",duration:3500}),setTimeout((()=>{o.value=!1}),6e4)):(0,A.bM)({title:"失败",message:e.msg,type:"error",duration:3500})},t=async()=>{a.value=!0;const o=(e,o,s)=>e!==o||((0,A.bM)({title:"错误",message:s,type:"error",duration:3500}),a.value=!1,!1);if(!1===o(s.nickname,"","请输入用户名")||!1===o(s.password,"","请输入密码")||!1===o(s.email,"","请输入邮箱")||!1===o(s.agreement,!1,"请同意用户协议")||!1===o(s.email.search(/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/),-1,"请确认邮箱格式是否正确"))return!1;const{data:l}=await q(s);"ok"===l.msg?((0,A.bM)({title:"成功",message:"注册成功，正在跳转登录",type:"success",duration:3500}),e.go(0)):((0,A.bM)({title:"失败",message:"注册失败，正在跳转首页",type:"success",duration:3500}),e.go(-1))};return{registerInfo:s,GetVerifyCode:l,register:t}};var j={setup(){const e=(0,M.tv)(),a=(0,z.iH)(!1),o=()=>{a.value=!a.value},s=()=>{e.push("/")},l=(0,z.iH)(!1),t=(0,z.iH)(!1),{loginInfo:n,login:r}=G(e,t),{registerInfo:i,GetVerifyCode:d,register:m}=H(e,t,l);return{goBack:s,loginOrRegisterButtonStatus:t,verifyCodeButtonStatus:l,LoginIsRegister:a,LoginIsRegisterChange:o,login:r,loginInfo:n,GetVerifyCode:d,registerInfo:i,register:m}}},$=o(89);const E=(0,$.Z)(j,[["render",Z],["__scopeId","data-v-7e2dba3e"]]);var X=E},924:function(e,a,o){o(2181)},5799:function(e,a,o){o(2181)}}]);